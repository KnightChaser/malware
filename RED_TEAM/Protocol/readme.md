

# π“΅ μ•”νΈν™” ν†µμ‹  ν”„λ΅ν† μ½ (Encrypted Communication Protocol)

μ΄ ν”„λ΅μ νΈλ” AESμ™€ RSA μ•”νΈν™” λ°©μ‹μ„ ν™μ©ν•μ—¬ **ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„ μ•μ „ν• λ°μ΄ν„° ν†µμ‹ **μ„ μ κ³µν•©λ‹λ‹¤. ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ RSA κ³µκ°ν‚¤λ΅ AES ν‚¤λ¥Ό μ•”νΈν™”ν•μ—¬ μ „μ†΅ν•λ©°, μ΄ν›„ λ°μ΄ν„°λ” AESλ¥Ό ν†µν•΄ μ•”νΈν™”ν•μ—¬ μ „μ†΅ν•©λ‹λ‹¤. λ³Έ ν”„λ΅ν† μ½μ€ ν…μ¤νΈ, μ‹¤ν–‰ νμΌ, μ΄λ―Έμ§€, λΉ„λ””μ¤ λ“± λ‹¤μ–‘ν• λ°μ΄ν„° μ ν•μ„ μ§€μ›ν•©λ‹λ‹¤.

## π›  κΈ°λ¥ κ°μ”

- **μ•μ „ν• ν‚¤ κµν™**: AES ν‚¤λ¥Ό RSA μ•”νΈν™”ν•μ—¬ μ „μ†΅
- **λ‹¤μ–‘ν• λ°μ΄ν„° μ ν• μ§€μ›**: ν…μ¤νΈ, μ‹¤ν–‰ νμΌ, μ΄λ―Έμ§€, λΉ„λ””μ¤, JSON λ°μ΄ν„° λ“±
- **`ProtocolMessage` ν΄λμ¤**: μ§λ ¬ν™”, μ•”νΈν™”, μ—­μ§λ ¬ν™” μ²λ¦¬
- **μ„λ²„μ™€ ν΄λΌμ΄μ–ΈνΈ κµ¬μ΅°**: RSA κ³µκ° ν‚¤ κµν™μ„ ν†µν• AES ν‚¤ μ•”νΈν™”/λ³µνΈν™”
- **μƒνƒ κΈ°λ° μ„¤κ³„**: λ‚μ λ° λ™μ  μƒνƒλ¥Ό ν™μ©ν• λ³΄μ• κ°•ν™”
- **ν—¤λ” λ‚λ…ν™”**: ν¨ν‚· κµ¬μ΅°μ™€ λ°μ΄ν„°μ λ…Έμ¶μ„ λ°©μ§€

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

π“¦ ν”„λ΅μ νΈ λ£¨νΈ  
β”β”€β”€ protocol_message.py   # ProtocolMessage ν΄λμ¤ μ •μ  
β”β”€β”€ client.py             # ν΄λΌμ΄μ–ΈνΈ μ½”λ“  
β””β”€β”€ server.py             # μ„λ²„ μ½”λ“  

## π€ μ„¤μΉ

1. μμ΅΄μ„± μ„¤μΉ
   ```bash
   pip install pycryptodome
   ```

2. μ €μ¥μ† ν΄λ΅ 
   ```bash
   git clone <repository-url>
   cd <repository-name>
   ```

## π“‹ μ‚¬μ©λ²•

1. μ„λ²„ μ‹μ‘
   ```bash
   python server.py
   ```

2. ν΄λΌμ΄μ–ΈνΈμ—μ„ λ°μ΄ν„° μ „μ†΅

   - ν…μ¤νΈ μ „μ†΅
     ```python
     send_data_to_server(text="Hello, this is a test message")
     ```

   - νμΌ μ „μ†΅
     ```python
     send_data_to_server(file_path="path/to/your/file", request_type="EXECUTABLE")
     ```

## π” λ³΄μ• μ„¤κ³„

### **1. AES λ° RSA μ•”νΈν™” νλ¦„**
- **AES μ•”νΈν™”**: λ€μΉ­ ν‚¤ μ•”νΈν™” λ°©μ‹μΌλ΅, λ°μ΄ν„° μ „μ†΅ κ³Όμ •μ—μ„ λΉ λ¥΄κ³  ν¨μ¨μ μΈ μ•”νΈν™”λ¥Ό μν–‰ν•©λ‹λ‹¤.
- **RSA μ•”νΈν™”**: λΉ„λ€μΉ­ ν‚¤ μ•”νΈν™” λ°©μ‹μΌλ΅, AES λ€μΉ­ ν‚¤λ¥Ό μ•μ „ν•κ² κµν™ν•©λ‹λ‹¤.
- **λλ¤ ν¨λ”© λ° λ°μ΄ν„° μ‚½μ…**: μ•”νΈν™”λ λ°μ΄ν„°μ— μ¶”κ°€μ μΈ λ¬΄μ‘μ„μ„±μ„ μ‚½μ…ν•μ—¬ λ°μ΄ν„° ν¨ν„΄ λ¶„μ„μ„ λ°©μ§€ν•©λ‹λ‹¤.

### **2. λ°μ΄ν„° λ‚λ…ν™” λ°©μ§€ κΈ°λ²•**

#### **2.1 ν¨λ”©(Padding)**
- λ¨λ“  λ°μ΄ν„° ν¨ν‚·μ€ κ³ μ •λ ν¬κΈ°λ¥Ό μ μ§€ν•λ„λ΅ λλ¤ λ°μ΄ν„°λ¥Ό μ¶”κ°€ν•μ—¬ ν¨ν‚· κΈΈμ΄λ¥Ό μΌμ •ν•κ² λ§λ“­λ‹λ‹¤.
- μ•”νΈν™”λ λ°μ΄ν„°μ™€ μ‹¤μ  λ°μ΄ν„° κ°„μ κ²½κ³„λ¥Ό μ¨κΉ€μΌλ΅μ¨ λ°μ΄ν„°μ λ…Έμ¶ μ„ν—μ„ μ¤„μ…λ‹λ‹¤.

#### **2.2 XOR μ—°μ‚°μ„ μ΄μ©ν• λ³€ν•**
- λ°μ΄ν„°λ¥Ό μ „μ†΅ν•κΈ° μ „μ— μ„μμ XOR ν‚¤λ¥Ό μ μ©ν•μ—¬ μ›λ³Έ λ°μ΄ν„°μ ν¨ν„΄μ„ κ°μ¶¥λ‹λ‹¤.
- λ³µνΈν™” κ³Όμ •μ—μ„λ” λ™μΌν• XOR ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μ›λ³Έ λ°μ΄ν„°λ¥Ό λ³µκµ¬ν•©λ‹λ‹¤.

#### **2.3 κ°€μ§ λ°μ΄ν„° μ‚½μ…**
- μ‹¤μ  λ°μ΄ν„° μ‚¬μ΄μ— λ¬΄μ‘μ„λ΅ μƒμ„±λ κ°€μ§ λ°μ΄ν„°λ¥Ό μ‚½μ…ν•μ—¬ λ°μ΄ν„°μ κµ¬μ΅°λ¥Ό λ³µμ΅ν•κ² λ§λ“­λ‹λ‹¤.
- κ°€μ§ λ°μ΄ν„°λ¥Ό ν•„ν„°λ§ν•κΈ° μ„ν• λ³„λ„μ λ©”νƒ€λ°μ΄ν„°λ¥Ό ν¬ν•¨ν•©λ‹λ‹¤.

### **3. ν—¤λ” λ‚λ…ν™”**
- μ•”νΈν™”λ ν—¤λ” λ°μ΄ν„°λ¥Ό **AES GCM** λ¨λ“λ΅ μ•”νΈν™”ν•μ—¬ λ¬΄κ²°μ„±μ„ κ²€μ¦ν•©λ‹λ‹¤.
- λ°μ΄ν„° λ‚΄λ¶€μ— μ„μμ ν•΄μ‹κ°’ λ° μ‹κ·Έλ‹μ²λ¥Ό μ¶”κ°€ν•μ—¬ ν—¤λ” λ³€μ΅°λ¥Ό λ°©μ§€ν•©λ‹λ‹¤.
- μ”μ²­ μ ν•(Request Type)κ³Ό λ°μ΄ν„° μ ν•(Data Type) μ •λ³΄λ¥Ό λ‚μ κΈ°λ° κ°’μΌλ΅ λ™μ μΌλ΅ λ³€ν™ν•μ—¬ λ¶„μ„ κ°€λ¥μ„±μ„ μ°¨λ‹¨ν•©λ‹λ‹¤.

### **4. λ„¤νΈμ›ν¬ νΈλν”½ λ³΄νΈ**
- λ¨λ“  λ°μ΄ν„° ν¨ν‚·μ€ κ³ μ ν• μ„Έμ… IDλ¥Ό ν¬ν•¨ν•μ—¬ μ”μ²­μ„ μ‹λ³„ν•λ©°, μ΄λ¥Ό ν†µν•΄ **μ¤‘κ°„μ κ³µκ²©**(MITM)μ„ λ°©μ§€ν•©λ‹λ‹¤.
- TLS/SSL κΈ°λ° μ•”νΈν™” μ±„λ„μ„ μ¶”κ°€λ΅ μ‚¬μ©ν•μ—¬ λ„¤νΈμ›ν¬ μ „μ†΅ μ¤‘ λ°μ΄ν„° κ°€λ΅μ±„κΈ° λ°©μ§€.

### **5. μ•”νΈν™” λ° λ‚λ…ν™” κ°μ„  κΈ°λ²•**
- **λ©€ν‹°λ μ΄μ–΄ μ•”νΈν™”**: λ°μ΄ν„°λ” AESλ΅ μ•”νΈν™”λ ν›„ μ¶”κ°€μ μΌλ΅ RSA ν‚¤λ΅ μ•”νΈν™”λμ–΄ λ‘ κ°€μ§€ λ³΄μ• λ μ΄μ–΄λ¥Ό μ κ³µν•©λ‹λ‹¤.
- **λ‹¤μ–‘ν• λ‚μ μƒμ„±κΈ° μ‚¬μ©**: μ•μ „ν• ν‚¤μ™€ λ°μ΄ν„° λ³€ν™μ„ μ„ν•΄ OS κΈ°λ° μ•μ „ν• λ‚μ μƒμ„±κΈ°λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.
- **μƒνƒ κΈ°λ° λ°μ΄ν„° λ³€ν™**: ν„μ¬μ λ™μ  μƒνƒ(State)μ— λ”°λΌ λ°μ΄ν„°λ¥Ό λ³€ν™ν•μ—¬ λ¶„μ„ κ°€λ¥μ„±μ„ λ‚®μ¶¥λ‹λ‹¤.

### **6. λ°μ΄ν„° λ¬΄κ²°μ„± κ²€μ¦**
- **GCM (Galois/Counter Mode)**: AES μ•”νΈν™”μ— GCM λ¨λ“λ¥Ό μ‚¬μ©ν•μ—¬ μ•”νΈν™”μ™€ ν•¨κ» μΈμ¦ νƒκ·Έλ¥Ό μƒμ„±, λ°μ΄ν„° λ³€μ΅°λ¥Ό νƒμ§€.
- **ν•΄μ‹ κΈ°λ° μ„λ…**: SHA256κ³Ό κ°™μ€ ν•΄μ‹ μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν•΄ λ°μ΄ν„°μ λ¬΄κ²°μ„±μ„ λ³΄μ¥.


## π’΅ ν•µμ‹¬ μ½”λ“ μ„¤λ…

### ProtocolMessage ν΄λμ¤

`ProtocolMessage` ν΄λμ¤λ” λ°μ΄ν„° μ§λ ¬ν™”, μ•”νΈν™”, λ³µνΈν™”μ— ν•„μ”ν• ν•µμ‹¬ κΈ°λ¥μ„ μν–‰ν•©λ‹λ‹¤.

- μƒμ„±μ
  ```python
  def __init__(self, session_id, request_type, data_type, payload):
      self.session_id = session_id
      self.request_type = request_type
      self.data_type = data_type
      self.payload = payload
      self.key = ProtocolMessage.shared_key  # κ³µμ λ AES ν‚¤ μ‚¬μ©
  ```

- AES μ•”νΈν™”
  ```python
  def encrypt_payload(self):
      cipher = AES.new(self.key, AES.MODE_GCM)
      ciphertext, tag = cipher.encrypt_and_digest(self.payload)
      return cipher.nonce, ciphertext, tag
  ```

- μ§λ ¬ν™”
  ```python
  def serialize(self):
      # μ•”νΈν™”λ νμ΄λ΅λ“μ™€ λ©”νƒ€λ°μ΄ν„°λ¥Ό μ§λ ¬ν™”ν•μ—¬ μ „μ†΅ κ°€λ¥ν• λ°”μ΄νΈ ν•νƒλ΅ λ³€ν™
  ```

- ν—¤λ” λ‚λ…ν™” λ° μ¶”κ°€ λ°μ΄ν„°
  ```python
  def generate_dynamic_header(self, ciphertext):
      # ν—¤λ” μƒμ„± μ‹ λ‚μ κΈ°λ° λ°μ΄ν„° λ° μ¶”κ°€ κ°€μ§ λ°μ΄ν„°λ¥Ό μ‚½μ…ν•μ—¬ λ‚λ…ν™”
  ```

## π“ λΌμ΄μ„ μ¤

MIT λΌμ΄μ„ μ¤ ν•μ— λ°°ν¬λ©λ‹λ‹¤.

## π¤ κΈ°μ—¬

1. μ΄ μ €μ¥μ†λ¥Ό ν¬ν¬ν•©λ‹λ‹¤.
2. μƒλ΅μ΄ κΈ°λ¥μ— λ€ν• λΈλμΉλ¥Ό μƒμ„±ν•©λ‹λ‹¤.
   ```bash
   git checkout -b feature/AmazingFeature
   ```
3. λ³€κ²½ μ‚¬ν•­μ„ μ»¤λ°‹ν•©λ‹λ‹¤.
   ```bash
   git commit -m 'Add some AmazingFeature'
   ```
4. λΈλμΉμ— ν‘Έμ‹ν•©λ‹λ‹¤.
   ```bash
   git push origin feature/AmazingFeature
   ```
5. Pull Requestλ¥Ό μ—½λ‹λ‹¤.

## π“ κ³ λ ¤ μ‚¬ν•­

- **κ³µκ° ν‚¤ λ‚λ…ν™”**: RSA κ³µκ° ν‚¤ μ„¤μ • κ³Όμ •μ΄ ν¨ν‚·μ—μ„ λ…Έμ¶λ  μ μμΌλ―€λ΅ μ΄λ¥Ό μΈμ½”λ”©ν•μ—¬ λ³΄μ™„
- **μ¶”κ°€ ν¨λ”© λ° μ„μ¥ λ°μ΄ν„° μ‚½μ…**: λ°μ΄ν„° κµ¬μ΅°λ¥Ό λ¶κ·μΉ™ν™”ν•μ—¬ λ¶„μ„ λ° κ³µκ²©μ„ μ–΄λ µκ² λ§λ“¦
